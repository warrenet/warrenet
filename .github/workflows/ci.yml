name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: read

jobs:
  check:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v6
      
      - name: Check repository structure
        run: |
          echo "‚úÖ Repository structure checked"
          echo ""
          echo "üìä Repository Analysis:"
          echo "====================="
          
          # Check for various language ecosystems
          if [ -f "package.json" ]; then
            echo "- ‚úÖ Node.js/JavaScript/TypeScript detected"
          fi
          if [ -f "go.mod" ]; then
            echo "- ‚úÖ Go detected"
          fi
          if [ -f "requirements.txt" ] || [ -f "setup.py" ] || [ -f "pyproject.toml" ]; then
            echo "- ‚úÖ Python detected"
          fi
          if [ -f "Cargo.toml" ]; then
            echo "- ‚úÖ Rust detected"
          fi
          if find . -name "*.csproj" -o -name "*.sln" 2>/dev/null | grep -q .; then
            echo "- ‚úÖ C#/.NET detected"
          fi
          
          echo ""
          echo "üìÑ README validation..."
          if [ -f "README.md" ]; then
            echo "- ‚úÖ README.md exists"
            # Validate README has required sections
            if grep -q "About Me" README.md; then
              echo "- ‚úÖ About Me section found"
            fi
            if grep -q "Skills" README.md || grep -q "Technologies" README.md; then
              echo "- ‚úÖ Skills section found"
            fi
          else
            echo "- ‚ùå README.md not found"
            exit 1
          fi
          
          echo ""
          echo "üîß GitHub configuration..."
          if [ -d ".github/workflows" ]; then
            workflow_count=$(find .github/workflows -name "*.yml" -o -name "*.yaml" | wc -l)
            echo "- ‚úÖ Found $workflow_count workflow(s)"
          fi
          
          echo ""
          echo "‚ú® All checks passed!"
      
      - name: Validate workflow syntax
        run: |
          echo "Checking workflow files syntax..."
          for file in .github/workflows/*.yml; do
            if [ -f "$file" ]; then
              echo "Checking $file..."
              # Basic YAML validation using Python
              python3 -c "import yaml; yaml.safe_load(open('$file'))" && echo "  ‚úÖ Valid" || echo "  ‚ùå Invalid"
            fi
          done
